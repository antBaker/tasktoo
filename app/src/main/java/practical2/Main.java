/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package practical2;


import com.fasterxml.jackson.dataformat.xml.XmlMapper;
import com.fasterxml.jackson.dataformat.xml.annotation.JacksonXmlElementWrapper;


import java.io.InputStreamReader;
import java.nio.charset.StandardCharsets;
import java.util.*;
import java.util.stream.Collectors;

public class Main {

    public static class Records {
        @JacksonXmlElementWrapper(useWrapping = false)
        public List<Record> record;
    }

    public static void main(String[] args) {
        try {
            // Ask the user which fields they want
            if (args.length > 0) {
                System.out.println("Arguments received: " + String.join(", ", args));
                // Your existing logic for handling the arguments
            }
            String inputFields =  String.join(", ", args);

            Set<String> fieldsToPrint = Arrays.stream(inputFields.split(","))
                                              .map(String::trim)
                                              .collect(Collectors.toSet());

            InputStreamReader reader = new InputStreamReader(
                Main.class.getClassLoader().getResourceAsStream("data.xml"),
                StandardCharsets.UTF_8
            );
            

            XmlMapper xmlMapper = new XmlMapper();
            Records records = xmlMapper.readValue(reader, Records.class);

            for (Record rec : records.record) {
                System.out.println("========== Record ==========");
                if (fieldsToPrint.contains("name")) {
                    System.out.println("Name: " + rec.name);
                }
                if (fieldsToPrint.contains("postalZip")) {
                    System.out.println("PostalZip: " + rec.postalZip);
                }
                if (fieldsToPrint.contains("region")) {
                    System.out.println("Region: " + rec.region);
                }
                if (fieldsToPrint.contains("country")) {
                    System.out.println("Country: " + rec.country);
                }
                if (fieldsToPrint.contains("address")) {
                    System.out.println("Address: " + rec.address);
                }
                if (fieldsToPrint.contains("list")) {
                    System.out.println("List: " + rec.getList());
                }
            }
            //System.out.println("Testing UTF-8 output: São Paulo, Québec, München, 東京");

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}